\documentclass[12pt]{article}

% set margins according to Reimer's wishes
\usepackage[margin=1.0in]{geometry}

% nag if old commands or packages used
\usepackage{nag}

\usepackage{graphicx}
\usepackage{rotating}
\usepackage{float}
\usepackage{hyperref}
\usepackage{siunitx}
\usepackage{mhchem}
\usepackage{subfig}

\title{Simulation ((( name )))}
\author{
        Henry Baxter \\
                Department of Physics and Astronomy\\
        University of Victoria\\
        henry.baxter@gmail.com
}
\date{\today}


\begin{document}
\maketitle

\begin{abstract}
An EGSnrc simulation was run on ((( name ))).

The X-ray source consisted of an xray tube with the following parameters.
\begin{itemize}
	\item Tungsten target angle: \ang{((( args.target_angle )))}
	\item Distance from electron gun to target: \SI{((( args.beam_distance )))}{\cm}
	\item Electron beam size: \SI{((( args.beam_width * 10 )))}{\mm} x \SI{((( args.beam_height * 10 )))}{\mm}
	\item Incident electrons simulated (histories): ((( args.histories )))
	\item Tungsten target length: \SI{((( args.target_length )))}{\cm}
	\item Gap between simulated electron beams: \SI{((( args.beam_gap )))}{\cm}
\begin{itemize}

The generated X-rays were then filtered with the following materials.
\begin{itemize}
	((* for slab in filter.slabs *))
	\item \SI{((( slab.zthick )))}{\cm} of ((( slab.medium|medium )))
	((* endfor *))
\end{abstract}

The collimator had the following properties.
\begin{itemize}
	\item Distance from anode to exit: \SI{((( collimator_stats['length'] )))}{\cm}
	\item Number of holes: ((( collimator_stats['blocks'][0]['regions'] )))
	\item Number of interpolating BLOCK CMs: ((( collimator_stats['total_blocks'] )))
	\item Total area of holes on anode side: ((( collimator_stats['anode_area'] )))
	\item Total area of holes at exit: ((( collimator_stats['exit_area'] )))
\end{itemize}

After collimation a phantom was dosed.
\begin{itemize}
	\item Target size: \SI{((( args.target_size )))}
	\item Target depth: \SI{((( args.target_z | abs )))}
	\item Distance from collimator to skin: \SI{((( args.target_distance - abs(args.target_z) )))}
	\item Paddick's conformity index: ((( paddicks )))
	\item Mean skin dose over mean target dose: ((( skin_to_target )))
	\item Distance from 20\% to 80\% isodose:
		\begin{itemize}
		\item X: ((( isodose_distance['x'] )))
		\item Y: ((( isodose_distance['y'] )))
		\item Z: ((( isodose_distance['z'] )))
		\end{itemize}
\end{itemize}

\clearpage

\tableofcontents


((* for plot_type in ['scatter', 'fluence', 'spectral', 'angular'] *))
	\section{((( plot_type.title() ))) Plots}
		
		((* for plot in [p if p['type'] == plot_type] *))
			\subsection{(((plot.name)))}
			\begin{figure}[H]
			\centering
			\includegraphics[scale=0.7,angle=270]{(((plot.path|strip_extension)))}
			\caption{(((plot.name)))}
			\label{fig:(((plot.slug)))}
			\end{figure}
		((* endfor *))

((* endfor *))

\section{Dose distributions}

((* for plot in contour_plots *))
	\susection{(((plot.name)))}
	\begin{figure}[H]
	\centering
	\includegraphics[]{(((plot.path|strip_extension)))}
	\caption{(((plot.name)))}
	\label{fig:(((plot.slug)))}
	\end{figure}
((* endfor *))

\section{Arced dose distributions}
((* for plot in arc_contour_plots *))
	\susection{(((plot.name)))}
	\begin{figure}[H]
	\centering
	\includegraphics[]{(((plot.path|strip_extension)))}
	\caption{(((plot.name)))}
	\label{fig:(((plot.slug)))}
	\end{figure}
((* endfor *))


\end{document}

